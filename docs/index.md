# Documentation Index

This directory contains documentation for the tiles Kubernetes cluster infrastructure. Each document covers a specific aspect of the system architecture, configuration, or operational procedures.

## Core Documentation

- **[overview.md](overview.md)**: High-level overview of the tiles project, explaining the fundamental motivations and architectural decisions behind building a Kubernetes cluster infrastructure, including the transition from ad-hoc maintenance to infrastructure-as-code approaches.

- **[components.md](components.md)**: Index of all software components deployed in the tiles cluster, with links to Terraform configurations, Application manifests, README documentation, and brief descriptions of each component's purpose.

- **[cluster-network.md](cluster-network.md)**: Detailed network architecture and configuration for Kubernetes clusters running on Talos VMs within Proxmox hosts, including IP range allocations, CIDR blocks, Cilium configuration, and network topology.

## Infrastructure Management

- **[environment-strategy.md](environment-strategy.md)**: Strategy for managing parallel Terraform environments (test and production) using a tag-based deployment workflow, with side-by-side configuration files for easy comparison and review in pull requests.

- **[config-propagation.md](config-propagation.md)**: Describes how configuration values flow from Terraform through 1Password to the bootstrap process and into individual Helm charts via the ArgoCD app-of-apps pattern, handling both dynamically created and static environment-specific values.

- **[bare-metal-nodes.md](bare-metal-nodes.md)**: Process for adding bare-metal nodes to the Talos cluster, including computing different installation manifests, removing QEMU guest agent dependencies, and configuring physical hardware nodes as single worker nodes.

- **[talos.md](talos.md)**: Talos Linux installation and upgrade procedures, including the specific image schematic with QEMU guest agent extension, ISO download links, and installation image references for both initial setup and upgrades.

## Storage and Networking

- **[nfs-storage-architecture.md](nfs-storage-architecture.md)**: NFS storage architecture using Synology NAS, explaining how the NFS CSI driver creates unique directories per PVC, Synology NFS export path requirements, and the relationship between cluster NFS paths and Synology shared folder exports.

## Security and Secrets

- **[secrets.md](secrets.md)**: Secret management strategy using 1Password vaults, documenting which secrets are generated by Terraform bootstrap versus manually created, including Talos machine secrets generation procedures and storage locations.

- **[gcp-enterprise-setup.md](gcp-enterprise-setup.md)**: GCP enterprise foundation setup inspired by the Security Foundations Blueprint, describing the four GCP projects created (tiles-id, tiles-kms, tiles-tf-state, tiles-main) and their purposes for workload identity, KMS, state storage, and general resources.

## Development and Operations

- **[dev-setup.md](dev-setup.md)**: Quick reference for developer setup, including commands to retrieve kubeconfig and talosconfig from 1Password and configure local kubectl and talosctl access to the test cluster.

- **[ci-principles.md](ci-principles.md)**: CI/CD principles emphasizing assertive (not adaptive) behavior, where conditionals about environment state are errors and tools should either be installed or fail explicitly rather than checking for existence.

- **[caching-strategy.md](caching-strategy.md)**: Caching strategy for GitHub Actions workflows using date-based invalidation and content-based keys to speed up CI/CD pipelines by avoiding redundant downloads and installations while ensuring caches stay fresh.

- **[oom-troubleshooting.md](oom-troubleshooting.md)**: Guide for diagnosing OOM (Out of Memory) kills, including how to identify which pods were killed, check their resource limits, and understand cgroup paths from Talos OOM logs.

## Monitoring and Observability

- **[monitoring-mixins.md](monitoring-mixins.md)**: Approach to collecting, customizing, and installing Prometheus monitoring mixins using Tanka plugin in ArgoCD to generate Kubernetes resources (Prometheus Operator objects and Grafana ConfigMaps) from mixin definitions.

- **[component-readme-plan.md](component-readme-plan.md)**: Plan for adding README.md files for each component in the tiles cluster, outlining the structure, location conventions, and linking strategy from the main component index.

## Build and API Management

- **[api-versions-strategy.md](api-versions-strategy.md)**: Strategy for extracting and maintaining API versions used for Helm templating with higher fidelity, storing cluster API version information in version-controlled files for use during CI builds without requiring cluster connectivity.

## Planning

- **[todo.md](todo.md)**: Future work items and planned improvements, including OIDC setup for ArgoCD, porting components from the tales cluster, setting up LGTM stack, Grafana authentication, workload identity federation, and Synology management via Terraform.
