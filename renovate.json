{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Renovate configuration for tiles repository - manages Helm charts, Jsonnet dependencies, Terraform, and more",

  "_comment_manual_run": "To run Renovate manually (CLI):",
  "_comment_manual_run_1": "1. Install: npm install -g renovate (or use Docker: docker pull renovate/renovate)",
  "_comment_manual_run_2": "2. Set GITHUB_TOKEN environment variable: export GITHUB_TOKEN=ghp_...",
  "_comment_manual_run_3": "3. Run: renovate --platform=github --token=$GITHUB_TOKEN symmetry/tiles",
  "_comment_manual_run_4": "   Or with Docker: docker run -e GITHUB_TOKEN renovate/renovate symmetry/tiles",
  "_comment_manual_run_5": "4. For dry-run (no PRs): add --dry-run flag",
  "_comment_manual_run_6": "",
  "_comment_manual_run_7": "Alternatively, install the Renovate GitHub App from https://github.com/apps/renovate",
  "_comment_manual_run_8": "The app will automatically use this config file and run on a schedule.",

  "extends": [
    "config:recommended"
  ],

  "enabledManagers": [
    "helm-values",
    "helmv3",
    "jsonnet-bundler",
    "terraform",
    "github-actions",
    "dockerfile",
    "docker-compose"
  ],

  "packageRules": [
    {
      "description": "Helm chart dependencies - group patch/minor updates, separate PRs for major",
      "matchManagers": ["helmv3"],
      "matchFileNames": ["charts/**/Chart.yaml"],
      "groupName": "helm chart dependencies",
      "groupSlug": "helm-charts",
      "semanticCommitType": "chore",
      "semanticCommitScope": "deps",
      "updateTypes": ["patch", "minor"],
      "automerge": false,
      "schedule": ["before 8am on monday"]
    },
    {
      "description": "Helm chart major version updates - separate PRs",
      "matchManagers": ["helmv3"],
      "matchFileNames": ["charts/**/Chart.yaml"],
      "updateTypes": ["major"],
      "automerge": false,
      "schedule": ["before 8am on the first day of the month"],
      "groupName": null
    },
    {
      "description": "Jsonnet dependencies - update weekly, group by source",
      "matchManagers": ["jsonnet-bundler"],
      "matchFileNames": ["tanka/jsonnetfile.json"],
      "groupName": "jsonnet dependencies",
      "groupSlug": "jsonnet",
      "semanticCommitType": "chore",
      "semanticCommitScope": "jsonnet",
      "automerge": false,
      "schedule": ["before 8am on monday"]
    },
    {
      "description": "Terraform providers - group by directory",
      "matchManagers": ["terraform"],
      "matchFileNames": ["tf/**/*.tf"],
      "groupName": "terraform providers ({{parentDir}})",
      "groupSlug": "terraform-{{parentDir}}",
      "semanticCommitType": "chore",
      "semanticCommitScope": "terraform",
      "automerge": false,
      "schedule": ["before 8am on monday"]
    },
    {
      "description": "GitHub Actions - group updates",
      "matchManagers": ["github-actions"],
      "groupName": "github actions",
      "groupSlug": "github-actions",
      "semanticCommitType": "ci",
      "automerge": false,
      "schedule": ["before 8am on monday"]
    }
  ],

  "helmv3": {
    "fileMatch": [
      "^charts/[^/]+/Chart\\.yaml$"
    ]
  },

  "jsonnet-bundler": {
    "fileMatch": [
      "^tanka/jsonnetfile\\.json$"
    ]
  },

  "terraform": {
    "fileMatch": [
      "^tf/.*\\.tf$"
    ]
  },

  "prConvention": "conventional",
  "semanticCommits": "enabled",

  "prHourlyLimit": 2,
  "prConcurrentLimit": 5,

  "labels": ["dependencies", "renovate"],

  "commitMessagePrefix": "chore: ",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{newVersion}}",

  "ignorePresets": [],

  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security", "renovate"],
    "assignees": []
  },

  "timezone": "America/Los_Angeles"
}
